FROM openjdk:11


# install needed packages
RUN add-apt-repository universe
# Install pre-requisite packages.
# RUN apt-get install -y wget
# Download the PowerShell package file
# RUN wget https://github.com/PowerShell/PowerShell/releases/download/v7.4.0/powershell_7.4.0-1.deb_amd64.deb
# Install the PowerShell package
# RUN dpkg -i powershell_7.4.0-1.deb_amd64.deb

# install needed packages
RUN apt-get update && apt-get install -y ant  && apt-get install -y zip && apt-get install -y xmlstarlet && apt-get install -y powershell
# apt install openjdk-11-jre-headless
RUN mkdir -p izpack

COPY /ant-lib /usr/share/ant/lib/
COPY . izpack
WORKDIR /izpack
# RUN chmod 755 bin/compile.sh ==> Doesnt work


RUN cd  /izpack/
RUN git pull
RUN cd  /izpack/izPackCustomActions
						
# We need to compile SAGE Custom actions
RUN ant -file izPackCustomActions/build.xml all 

# COPY izPackCustomActions/bin/com.sage.izpack.jar /izpack/izPackCustomActions/com.sage.izpack.jar
